<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BMDTX8B88C"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-BMDTX8B88C');
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Fault Scenario 1: Titanium Forging System Failure</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">    <script src="worksheet-core.js"></script>
<script src="worksheet-tracking.js"></script>
<script src="shared-components.js"></script>

</head>
<body>
  <!-- Navigation -->
  <nav class="main-navigation">
    <div class="nav-container">
      <div class="nav-logo" onclick="window.location='index.html'" title="Go to Home">
        <img src="assets/matrix-logo.png" alt="Matrix Logo">
      </div>
      <ul class="nav-menu">
        <li class="nav-item">
          <a href="#" onclick="window.location='index.html'" class="nav-link">
            <i class="fas fa-home"></i> HOME
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp0539-worksheets.html'" class="nav-link">
            <i class="fas fa-cogs"></i> CP0539
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp6773-worksheets.html'" class="nav-link active">
            <i class="fas fa-exclamation-triangle"></i> CP6773
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='tracking-dashboard.html'" class="nav-link">
            <i class="fas fa-chart-line"></i> PROGRESS
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='about.html'" class="nav-link">
            <i class="fas fa-info-circle"></i> ABOUT
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='cp6773-worksheets.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Back to Fault Scenarios</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Fault Scenario 1 - Titanium Forging System Failure</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='fault-scenario-2.html'">
            <span>Next Scenario</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- Introduction Section -->
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> Fault Scenario 1: Titanium Forging System Won't Start</h2>
      <div class="worksheet-content">
        <div class="scenario-info">
          <div class="info-grid">
            <div class="info-item">
              <strong>Scenario:</strong> Titanium Forging System Won't Start
            </div>
            <div class="info-item">
              <strong>Process:</strong> Titanium forging for Boeing aeroplane frames
            </div>
            <div class="info-item">
              <strong>Shift:</strong> Night shift start
            </div>
            <div class="info-item">
              <strong>Urgency:</strong> High - Production line stopped
            </div>
            <div class="info-item">
              <strong>Difficulty:</strong> Beginner
            </div>
            <div class="info-item">
              <strong>Time:</strong> 20-30 minutes
            </div>
          </div>
        </div>

        <div class="background-section">
          <div class="background-text">
            <div class="scenario-description">
              <h3>Scenario Background</h3>
              <p>You work night shifts in a titanium forging factory that produces frames for Boeing aeroplanes. As you start your shift, you're told the system won't run, and no one knows why. The day shift maintenance engineer tells you they had a problem earlier in the day because the oil was too cold. Harry, the Marketing Manager, thinks it's just the Wi-Fi acting up again.</p>
            </div>
          </div>
          
          <div class="background-image">
            <img src="assets/scenarios/titanium-forge.png" alt="Titanium Forging System">
            <figcaption>Titanium Forging System - Aerospace Manufacturing</figcaption>
          </div>
        </div>

        <div class="system-overview">
          <h3>Initial System Status</h3>
          <div class="status-grid">
            <div class="status-item">
              <span class="status-label">Hydraulic Oil Temp:</span>
              <span class="status-value">45°C</span>
            </div>
            <div class="status-item">
              <span class="status-label">System Max Temp:</span>
              <span class="status-value">40°C</span>
            </div>
            <div class="status-item">
              <span class="status-label">System Min Temp:</span>
              <span class="status-value error">5°C</span>
            </div>

            <div class="status-item">
              <span class="status-label">System Ready:</span>
              <span class="status-value error">FAULT</span>
            </div>
            <div class="status-item">
              <span class="status-label">Production Status:</span>
              <span class="status-value error">STOPPED</span>
            </div>
            <div class="status-item">
              <span class="status-label">Wi-Fi Connection:</span>
              <span class="status-value normal" id="wifi-status">CONNECTED</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Troubleshooting Tips Section -->
    <div class="worksheet-section objectives-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> Troubleshooting Tips</h2>
      <div class="objectives-content">
        <ul class="objectives-list">
          <li>Don't assume the obvious issue is always the root cause</li>
          <li>Check system pressure readings even if pumps appear to be running</li>
          <li>Look for hydraulic leaks or isolation valve issues</li>
          <li>Verify that all safety interlocks are satisfied before startup</li>
        </ul>
      </div>
    </div>

    <!-- Investigation Tools Section - Commented out as requested -->
    <!-- <div class="worksheet-section tools-section">
      <h2 class="section-header"><i class="fas fa-tools"></i> Investigation Tools</h2>
      <div class="tools-content">
        <div class="tools-grid">
          <div class="tool-card" data-tool="check_pressure">
            <h4><i class="fas fa-search"></i> Check Pressure Sensors</h4>
            <p>Inspect hydraulic pressure sensors and readings</p>
            <button class="tool-btn" onclick="useTool('check_pressure')">Use Tool</button>
          </div>
          
          <div class="tool-card" data-tool="inspect_hydraulics">
            <h4><i class="fas fa-tint"></i> Inspect Hydraulic System</h4>
            <p>Check for leaks, valve positions, and fluid levels</p>
            <button class="tool-btn" onclick="useTool('inspect_hydraulics')">Use Tool</button>
          </div>
          
          <div class="tool-card" data-tool="check_interlocks">
            <h4><i class="fas fa-shield-alt"></i> Check Safety Interlocks</h4>
            <p>Verify all safety systems and emergency stops</p>
            <button class="tool-btn" onclick="useTool('check_interlocks')">Use Tool</button>
          </div>
          
          <div class="tool-card" data-tool="test_valves">
            <h4><i class="fas fa-cog"></i> Test Isolation Valves</h4>
            <p>Check position and operation of hydraulic isolation valves</p>
            <button class="tool-btn" onclick="useTool('test_valves')">Use Tool</button>
          </div>
        </div>
      </div>
    </div> -->

    <!-- Investigation Results Section -->
    <div class="worksheet-section results-section" id="investigation-results" style="display: none;">
      <h2 class="section-header"><i class="fas fa-clipboard-list"></i> Investigation Results</h2>
      <div class="results-content" id="results-content">
        <!-- Results will be populated by JavaScript -->
      </div>
    </div>

    <!-- Analysis Section -->
    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-clipboard-list"></i> Fault Analysis Worksheet</h2>
      <div class="questions-content">
        <div class="analysis-section">
          <h4>Observations:</h4>
          <textarea class="answer-input" data-question="observations" placeholder="Record your observations of the system behavior, readings, and any unusual indicators..."></textarea>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer('observations')">Save Observations</button>
          </div>
        </div>
        
        <div class="analysis-section">
          <h4>Problem:</h4>
          <textarea class="answer-input" data-question="problem" placeholder="Identify the root cause and describe the specific problem affecting the system..."></textarea>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer('problem')">Save Problem Analysis</button>
          </div>
        </div>
        
        <div class="analysis-section">
          <h4>Solution:</h4>
          <textarea class="answer-input" data-question="solution" placeholder="Describe the steps you would take to resolve the issue safely and effectively..."></textarea>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer('solution')">Save Solution</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Interactive Simulation Section - COMMENTED OUT -->
    <!-- NOTE: This simulation is fully working and working well. It provides an interactive temperature-based flow system 
         with dual gauges (flow rate + temperature), troubleshooting tools, and realistic fault scenario behavior.
         Uncomment this section to enable the fully functional simulation. -->
    <!-- <div class="worksheet-section simulation-section">
      <h2 class="section-header"><i class="fas fa-cogs"></i> Interactive Flow Rate System Simulation</h2>
      <div class="simulation-container">
        <div class="simulation-header">
          <h3><i class="fas fa-tint"></i> Titanium Forging Flow System</h3>
          <p>Experience the fault scenario in real-time. System requires temperature ≤40°C to operate</p>
        </div>
        
        <div class="simulation-grid">
          <div class="simulation-left">
            <div class="temperature-visualization">
              <h4>Flow Rate System Display</h4>
              <div class="temp-display-container">
                <div class="gauge-row">
                  <div class="temp-gauge-container">
                    <div id="temp-gauge" class="temp-gauge">
                      <div class="gauge-background"></div>
                      <div class="gauge-fill" id="gauge-fill"></div>
                      <div class="gauge-center">
                        <div class="temp-value" id="displayed-temp">0 L/h</div>
                        <div class="temp-label">Flow Rate</div>
                      </div>
                    </div>
                  </div>
                  <div class="temp-gauge-container">
                    <div id="temperature-gauge" class="temp-gauge">
                      <div class="gauge-background"></div>
                      <div class="gauge-fill" id="temperature-gauge-fill"></div>
                      <div class="gauge-center">
                        <div class="temp-value" id="temperature-gauge-value">45°C</div>
                        <div class="temp-label">Temperature</div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="temp-indicators">
                  <div class="temp-indicator">
                    <span class="indicator-label">Flow Rate:</span>
                    <span class="indicator-value" id="actual-temp">0 L/h</span>
                  </div>
                  <div class="temp-indicator">
                    <span class="indicator-label">Temperature:</span>
                    <span class="indicator-value error" id="setpoint-temp">45°C</span>
                  </div>
                  <div class="temp-indicator">
                    <span class="indicator-label">Flow Valve:</span>
                    <span class="indicator-value" id="offset-value">CLOSED</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="system-status">
              <h4>System Status</h4>
              <div class="status-grid-sim">
                <div class="status-item-sim">
                  <span class="status-label-sim">Pump Status:</span>
                  <span class="status-value-sim normal" id="alarm-status">READY</span>
                </div>
                <div class="status-item-sim">
                  <span class="status-label-sim">Temperature Alarm:</span>
                  <span class="status-value-sim error" id="quality-status">HIGH TEMP</span>
                </div>
                <div class="status-item-sim">
                  <span class="status-label-sim">Production:</span>
                  <span class="status-value-sim error" id="cooling-status">STOPPED</span>
                </div>
                <div class="status-item-sim">
                  <span class="status-label-sim">Max Temp Limit:</span>
                  <span class="status-value-sim normal" id="energy-status">40°C</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="simulation-right">
            <div class="control-panel">
              <h4>Control Panel</h4>
              <div class="control-buttons">
                <button id="toggle-valve" class="control-btn">Open Valve</button>
                <button id="reset-simulation" class="control-btn">Reset System</button>
              </div>
            </div>
            
            <div class="troubleshooting-tools">
              <h4>Troubleshooting Tools</h4>
              <div class="tool-buttons">
                <button id="check-offset" class="tool-btn-sim">Check Temperature</button>
                <button id="use-thermometer" class="tool-btn-sim">Use Portable Thermometer</button>
                <button id="review-reports" class="tool-btn-sim">Check Temp Sensor</button>
                <button id="adjust-offset" class="tool-btn-sim">Check Sensor Setup</button>
              </div>
            </div>
            
            <div class="diagnostic-log prominent-log">
              <h3><i class="fas fa-clipboard-list"></i> System Diagnostic Log</h3>
              <div id="log-container" class="log-container">
                <div class="log-entry error">System startup failed - temperature alarm</div>
                <div class="log-entry warning">Temperature: 45°C exceeds limit of 40°C</div>
                <div class="log-entry">Pump ready and valve operational</div>
                <div class="log-entry">Production halted due to high temperature</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="simulation-instructions">
          <h4>Instructions</h4>
          <ol>
            <li>Observe that the system shows temperature alarm preventing startup</li>
            <li>Notice that pump is ready and valve can operate normally</li>
            <li>Use troubleshooting tools to investigate the temperature issue</li>
            <li>Check if there's a problem with the temperature sensor reading</li>
            <li>Try adjusting the temperature sensor calibration to resolve the issue</li>
          </ol>
        </div>
      </div>
    </div> -->
  </div>

  <!-- Styles -->
  <style>
    .scenario-info {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    /* Simulation Styles */
    .simulation-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin: 20px 0;
    }
    
    .simulation-left, .simulation-right {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .temperature-visualization {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid #2196F3;
    }
    
    .temperature-visualization h4 {
      color: #2196F3;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .temp-display-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }
    
    .temp-gauge-container {
      position: relative;
      width: 200px;
      height: 200px;
    }
    
    .gauge-row {
      display: flex;
      gap: 30px;
      justify-content: center;
      align-items: center;
    }
    
    .temp-gauge {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    
    .gauge-background {
      position: absolute;
      width: 80%;
      height: 80%;
      border-radius: 50%;
      background: #222;
    }
    
    .gauge-fill {
      position: absolute;
      width: 80%;
      height: 80%;
      border-radius: 50%;
      background: conic-gradient(from 0deg, #FF5722 0deg, #FF5722 180deg, transparent 180deg, transparent 360deg);
      transition: all 0.5s ease;
    }
    
    .gauge-center {
      position: relative;
      z-index: 2;
      text-align: center;
      color: #FFFFFF;
    }
    
    .temp-value {
      font-size: 24px;
      font-weight: bold;
      color: #FFFFFF;
    }
    
    .temp-label {
      font-size: 12px;
      color: #AAA;
      margin-top: 5px;
    }
    
    .temp-indicators {
      display: flex;
      flex-direction: column;
      gap: 10px;
      width: 100%;
    }
    
    .temp-indicator {
      display: flex;
      justify-content: space-between;
      padding: 8px 12px;
      background: #444;
      border-radius: 4px;
    }
    
    .indicator-label {
      color: #AAA;
      font-weight: bold;
    }
    
    .indicator-value {
      color: #FFFFFF;
      font-weight: bold;
    }
    
    .system-status {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid #FF9800;
    }
    
    .system-status h4 {
      color: #FF9800;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .status-grid-sim {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    
    .status-item-sim {
      display: flex;
      justify-content: space-between;
      padding: 8px 12px;
      background: #444;
      border-radius: 4px;
    }
    
    .status-label-sim {
      color: #AAA;
      font-weight: bold;
    }
    
    .status-value-sim {
      color: #FFFFFF;
      font-weight: bold;
    }
    
    .status-value-sim.normal {
      color: #4CAF50;
    }
    
    .status-value-sim.warning {
      color: #FF9800;
    }
    
    .status-value-sim.error {
      color: #F44336;
    }
    
    .control-panel {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid #4CAF50;
    }
    
    .control-panel h4 {
      color: #4CAF50;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .control-group {
      margin-bottom: 15px;
    }
    
    .control-group label {
      display: block;
      color: #FFFFFF;
      margin-bottom: 5px;
      font-weight: bold;
    }
    
    .control-group input[type="range"] {
      width: 100%;
      margin-bottom: 5px;
    }
    
    .control-group span {
      color: #2196F3;
      font-weight: bold;
      font-size: 14px;
    }
    
    .control-buttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 15px;
    }
    
    .control-btn {
      background: #2196F3;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    
    .control-btn:hover {
      background: #1976D2;
      transform: translateY(-2px);
    }
    
    .troubleshooting-tools {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid #9C27B0;
    }
    
    .troubleshooting-tools h4 {
      color: #9C27B0;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .tool-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    
    .tool-btn-sim {
      background: #9C27B0;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    
    .tool-btn-sim:hover {
      background: #7B1FA2;
      transform: translateY(-1px);
    }
    
    .tool-btn-sim:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
    }
    
    .diagnostic-log {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid #607D8B;
    }
    
    .prominent-log {
      background: #2A2A2A;
      border: 2px solid #607D8B;
      box-shadow: 0 4px 20px rgba(96, 125, 139, 0.3);
      margin-top: 20px;
    }
    
    .prominent-log h3 {
      color: #607D8B;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 18px;
      font-weight: bold;
    }
    
    .diagnostic-log h4 {
      color: #607D8B;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .log-container {
      background: #222;
      border: 1px solid #555;
      border-radius: 4px;
      padding: 15px;
      height: 180px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 13px;
    }
    
    .prominent-log .log-container {
      height: 200px;
      font-size: 14px;
      background: #1A1A1A;
      border: 2px solid #444;
    }
    
    .log-entry {
      color: #4CAF50;
      margin-bottom: 5px;
      padding: 2px 0;
    }
    
    .log-entry.warning {
      color: #FF9800;
    }
    
    .log-entry.error {
      color: #F44336;
    }
    
    .log-entry.info {
      color: #2196F3;
    }
    
    .simulation-instructions {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      border-left: 4px solid #FF5722;
    }
    
    .simulation-instructions h4 {
      color: #FF5722;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .simulation-instructions ol {
      color: #FFFFFF;
      padding-left: 20px;
    }
    
    .simulation-instructions li {
      margin-bottom: 8px;
      line-height: 1.4;
    }
    
    @media (max-width: 768px) {
      .simulation-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .status-grid-sim {
        grid-template-columns: 1fr;
      }
      
      .tool-buttons {
        grid-template-columns: 1fr;
      }
      
      .gauge-row {
        flex-direction: column;
        gap: 20px;
      }
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }
    
    .info-item {
      color: #FFFFFF;
      padding: 10px;
      background: #444;
      border-radius: 4px;
    }
    
    .scenario-description {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .scenario-description h3 {
      color: #4CAF50;
      margin-bottom: 15px;
    }
    
    .scenario-description p {
      color: #FFFFFF;
      margin-bottom: 15px;
      line-height: 1.6;
    }
    
    .system-overview {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .system-overview h3 {
      color: #4CAF50;
      margin-bottom: 15px;
    }
    
    .status-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }
    
    .status-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: #444;
      border-radius: 4px;
    }
    
    .status-label {
      color: #AAA;
      font-weight: bold;
    }
    
    .status-value {
      color: #FFFFFF;
      font-weight: bold;
    }
    
    .status-value.normal {
      color: #4CAF50;
    }
    
    .status-value.warning {
      color: #FF9800;
    }
    
    .status-value.error {
      color: #F44336;
    }
    
    .system-diagram {
      text-align: center;
      margin: 20px 0;
    }
    
    .system-diagram img {
      max-width: 400px;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    .system-diagram figcaption {
      color: #FFFFFF;
      margin-top: 10px;
      font-style: italic;
    }
    
    .objectives-list {
      list-style: none;
      padding: 0;
    }
    
    .objectives-list li {
      color: #FFFFFF;
      padding: 10px 0;
      border-bottom: 1px solid #555;
      position: relative;
      padding-left: 30px;
    }
    
    .objectives-list li:before {
      content: "✓";
      color: #4CAF50;
      font-weight: bold;
      position: absolute;
      left: 0;
    }
    
    .tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .tool-card {
      background: #333;
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid #2196F3;
    }
    
    .tool-card h4 {
      color: #2196F3;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .tool-card p {
      color: #FFFFFF;
      margin-bottom: 15px;
    }
    
    .tool-btn {
      background: #2196F3;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    
    .tool-btn:hover {
      background: #1976D2;
    }
    
    .tool-btn:disabled {
      background: #666;
      cursor: not-allowed;
    }
    
    .question-item, .analysis-section {
      background: #333;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
    }
    
    .question-item h4, .analysis-section h4 {
      color: #FFFFFF;
      margin-bottom: 10px;
      font-size: 16px;
      font-weight: bold;
    }
    
    .analysis-section h4 {
      color: #4CAF50;
      border-bottom: 2px solid #4CAF50;
      padding-bottom: 5px;
    }
    
    .answer-input {
      width: 100%;
      height: 100px;
      padding: 10px;
      border: 1px solid #555;
      border-radius: 4px;
      background: #222;
      color: #FFFFFF;
      resize: vertical;
    }
    
    .submit-question-btn {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 10px;
    }
    
    .submit-question-btn:hover {
      background: #45a049;
    }
    
    /* Make Wi-Fi status box wider to accommodate "DISCONNECTED" text */
    #wifi-status {
      min-width: 120px;
      text-align: center;
    }
  </style>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  
  <script>
    // Simulation data
    let simulationData = {
      currentFlow: 0,
      displayedTemperature: 45, // Actual 12°C + 33°C offset
      actualTemperature: 12,
      temperatureOffset: 33,
      maxTemperature: 40,
      flowValve: 'CLOSED',
      pumpStatus: 'READY',
      pumpSpeed: 75,
      temperatureAlarm: 'HIGH TEMP',
      productionStatus: 'STOPPED',
      // Flow settings: system won't run if temp > 40°C
      valvePosition: 0, // 0 = closed, 1 = open
      maxFlow: 300,
      requiredFlow: 200
    };

    // Tool results data
    const toolResults = {
      'check_pressure': {
        title: 'Pressure Sensor Check',
        content: `
          <div class="result-item">
            <h4>Pressure System Analysis:</h4>
            <ul>
              <li>System Pressure Reading: 0 bar</li>
              <li>Required Operating Pressure: 200 bar</li>
              <li>Pressure Sensor Status: FUNCTIONING</li>
              <li>Pump Outlet Pressure: 205 bar</li>
              <li>Main Line Pressure: 0 bar</li>
            </ul>
            <p><strong>Analysis:</strong> Pumps are generating correct pressure, but main system shows zero pressure. This indicates a blockage or closed valve between pump and main system.</p>
          </div>
        `
      },
      'inspect_hydraulics': {
        title: 'Hydraulic System Inspection',
        content: `
          <div class="result-item">
            <h4>Physical System Check:</h4>
            <ul>
              <li>Hydraulic Oil Level: ADEQUATE</li>
              <li>Oil Temperature: 45°C (ACCEPTABLE)</li>
              <li>Visible Leaks: NONE DETECTED</li>
              <li>Pump Operation: NORMAL SOUND/VIBRATION</li>
              <li>Main Isolation Valve: CLOSED POSITION</li>
            </ul>
            <p><strong>Analysis:</strong> All hydraulic components appear normal except the main isolation valve is in the closed position, preventing pressure from reaching the forging system.</p>
          </div>
        `
      },
      'check_interlocks': {
        title: 'Safety Interlock Analysis',
        content: `
          <div class="result-item">
            <h4>Safety System Status:</h4>
            <ul>
              <li>Emergency Stop: NOT ACTIVATED</li>
              <li>Safety Guards: ALL CLOSED</li>
              <li>Pressure Interlock: WAITING FOR PRESSURE</li>
              <li>Temperature Interlock: SATISFIED</li>
              <li>Wi-Fi Network: CONNECTED (NOT CRITICAL)</li>
            </ul>
            <p><strong>Analysis:</strong> All safety interlocks are satisfied except the pressure interlock, which is waiting for adequate hydraulic pressure to enable system startup.</p>
          </div>
        `
      },
      'test_valves': {
        title: 'Valve Position Check',
        content: `
          <div class="result-item">
            <h4>Isolation Valve Status:</h4>
            <ul>
              <li>Main Isolation Valve: CLOSED</li>
              <li>Valve Position Indicator: MANUAL CLOSE</li>
              <li>Last Operation: Day shift maintenance</li>
              <li>Reason: "Oil too cold - valve closed for safety"</li>
              <li>Action Required: Open valve when oil temp OK</li>
            </ul>
            <p><strong>Analysis:</strong> The day shift closed the isolation valve when oil was too cold. Now that oil temperature is adequate (45°C > 40°C minimum), the valve can be safely opened.</p>
          </div>
        `
      }
    };

    // Use investigation tool
    function useTool(toolId) {
      const resultsSection = document.getElementById('investigation-results');
      const resultsContent = document.getElementById('results-content');
      const toolCard = document.querySelector(`[data-tool="${toolId}"]`);
      const toolBtn = toolCard.querySelector('.tool-btn');
      
      // Disable the tool button
      toolBtn.disabled = true;
      toolBtn.textContent = 'Used';
      
      // Show results
      const result = toolResults[toolId];
      resultsContent.innerHTML = `
        <h3>${result.title}</h3>
        ${result.content}
      `;
      resultsSection.style.display = 'block';
      
      // Scroll to results
      resultsSection.scrollIntoView({ behavior: 'smooth' });
    }

    // Submit answer
    function submitAnswer(questionType) {
      const input = document.querySelector(`[data-question="${questionType}"]`);
      const answer = input.value.trim();
      
      if (answer) {
        // Save to local storage for backward compatibility
        localStorage.setItem(`fault1_${questionType}`, answer);
        
        // Track with the tracking system if available
        if (typeof trackFaultScenarioAnswer === 'function') {
          trackFaultScenarioAnswer(questionType, answer);
        }
        
        const button = event.target;
        const originalText = button.textContent;
        button.textContent = 'Saved!';
        button.style.background = '#4CAF50';
        
        setTimeout(() => {
          button.textContent = originalText;
        }, 2000);
      } else {
        alert('Please enter content before saving.');
      }
    }

    // Load saved answers
    function loadSavedAnswers() {
      const questionTypes = ['observations', 'problem', 'solution'];
      questionTypes.forEach(type => {
        const saved = localStorage.getItem(`fault1_${type}`);
        if (saved) {
          const input = document.querySelector(`[data-question="${type}"]`);
          if (input) {
            input.value = saved;
          }
        }
      });
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      loadSavedAnswers();
      // initializeSimulation(); // Commented out with simulation section
      initializeEducationalNote(); // Add the educational note
      startWifiFlicker(); // Start Wi-Fi flickering
    });

    // Simulation Functions - COMMENTED OUT WITH SIMULATION SECTION
    /* 
    function initializeSimulation() {
      console.log('Initializing Temperature-Based Flow System Simulation');
      
      // Button event listeners
      document.getElementById('toggle-valve').addEventListener('click', toggleValve);
      document.getElementById('reset-simulation').addEventListener('click', resetSimulation);
      
      // Tool event listeners
      document.getElementById('check-offset').addEventListener('click', () => useSimulationTool('check-temp'));
      document.getElementById('use-thermometer').addEventListener('click', () => useSimulationTool('use-thermometer'));
      document.getElementById('review-reports').addEventListener('click', () => useSimulationTool('check-sensor'));
      document.getElementById('adjust-offset').addEventListener('click', () => useSimulationTool('calibrate-sensor'));
      
      // Initial update
      updateSimulation();
    }

    function toggleValve() {
      simulationData.valvePosition = simulationData.valvePosition === 1 ? 0 : 1;
      simulationData.flowValve = simulationData.valvePosition === 1 ? 'OPEN' : 'CLOSED';
      
      const toggleButton = document.getElementById('toggle-valve');
      toggleButton.textContent = simulationData.valvePosition === 1 ? 'Close Valve' : 'Open Valve';
      
      updateSimulation();
      addLogEntry(`Flow valve ${simulationData.flowValve.toLowerCase()}`, 'info');
    }

    function updateSimulation() {
      // Calculate displayed temperature (actual + offset)
      simulationData.displayedTemperature = simulationData.actualTemperature + simulationData.temperatureOffset;
      
      // Check if system can run (temperature must be <= 40°C)
      const temperatureOK = simulationData.displayedTemperature <= simulationData.maxTemperature;
      
      // Calculate flow rate: only flows if valve open AND temperature OK
      if (simulationData.valvePosition === 1 && temperatureOK) {
        simulationData.currentFlow = Math.round((simulationData.pumpSpeed / 100) * simulationData.maxFlow);
      } else {
        simulationData.currentFlow = 0;
      }
      
      // Update displays
      document.getElementById('displayed-temp').textContent = `${simulationData.currentFlow} L/h`;
      document.getElementById('actual-temp').textContent = `${simulationData.currentFlow} L/h`;
      document.getElementById('setpoint-temp').textContent = `${simulationData.displayedTemperature}°C`;
      document.getElementById('offset-value').textContent = simulationData.flowValve;
      document.getElementById('temperature-gauge-value').textContent = `${simulationData.displayedTemperature}°C`;
      
      // Update gauge (shows flow rate)
      updateFlowGauge();
      
      // Update temperature gauge
      updateTemperatureGauge();
      
      // Update status indicators
      updateStatusIndicators();
    }

    function updateFlowGauge() {
      const gaugeFill = document.getElementById('gauge-fill');
      const currentFlow = simulationData.currentFlow;
      
      // Calculate gauge fill percentage (range 0-300 L/h)
      const minFlow = 0;
      const maxFlow = 300;
      const percentage = Math.max(0, Math.min(100, ((currentFlow - minFlow) / (maxFlow - minFlow)) * 100));
      
      // Update gauge fill with flow-appropriate color
      let color = '#FF5722'; // Red for no flow
      if (currentFlow >= 50) {
        color = '#4CAF50'; // Green for adequate flow
      } else if (currentFlow > 0) {
        color = '#FF9800'; // Orange for low flow
      }
      
      gaugeFill.style.background = `conic-gradient(from 0deg, ${color} 0deg, ${color} ${percentage * 3.6}deg, transparent ${percentage * 3.6}deg, transparent 360deg)`;
    }

    function updateTemperatureGauge() {
      const tempGaugeFill = document.getElementById('temperature-gauge-fill');
      const displayedTemp = simulationData.displayedTemperature;
      
      // Calculate gauge fill percentage (range 0-60°C)
      const minTemp = 0;
      const maxTemp = 60;
      const percentage = Math.max(0, Math.min(100, ((displayedTemp - minTemp) / (maxTemp - minTemp)) * 100));
      
      // Update gauge fill with temperature-appropriate color
      let color = '#4CAF50'; // Green for low temp
      if (displayedTemp > simulationData.maxTemperature) {
        color = '#F44336'; // Red for over limit
      } else if (displayedTemp > 30) {
        color = '#FF9800'; // Orange for moderate temp
      }
      
      tempGaugeFill.style.background = `conic-gradient(from 0deg, ${color} 0deg, ${color} ${percentage * 3.6}deg, transparent ${percentage * 3.6}deg, transparent 360deg)`;
    }

    function updateStatusIndicators() {
      const currentFlow = simulationData.currentFlow;
      const displayedTemp = simulationData.displayedTemperature;
      const temperatureOK = displayedTemp <= simulationData.maxTemperature;
      
      // Update pump status (always ready)
      const pumpStatus = document.getElementById('alarm-status');
      pumpStatus.textContent = 'READY';
      pumpStatus.className = 'status-value-sim normal';
      
      // Update temperature alarm status
      const tempAlarm = document.getElementById('quality-status');
      if (temperatureOK) {
        tempAlarm.textContent = 'NORMAL';
        tempAlarm.className = 'status-value-sim normal';
      } else {
        tempAlarm.textContent = 'HIGH TEMP';
        tempAlarm.className = 'status-value-sim error';
      }
      
      // Update production status
      const productionStatus = document.getElementById('cooling-status');
      if (temperatureOK && currentFlow >= simulationData.requiredFlow) {
        productionStatus.textContent = 'RUNNING';
        productionStatus.className = 'status-value-sim normal';
      } else {
        productionStatus.textContent = 'STOPPED';
        productionStatus.className = 'status-value-sim error';
      }
      
      // Update max temp limit display
      const maxTempStatus = document.getElementById('energy-status');
      maxTempStatus.textContent = `${simulationData.maxTemperature}°C`;
      maxTempStatus.className = 'status-value-sim normal';
    }

    function resetSimulation() {
      simulationData = {
        currentFlow: 0,
        displayedTemperature: 45,
        actualTemperature: 12,
        temperatureOffset: 33,
        maxTemperature: 40,
        flowValve: 'CLOSED',
        pumpStatus: 'READY',
        pumpSpeed: 75,
        temperatureAlarm: 'HIGH TEMP',
        productionStatus: 'STOPPED',
        valvePosition: 0,
        maxFlow: 300,
        requiredFlow: 200
      };
      
      // Reset toggle button
      const toggleButton = document.getElementById('toggle-valve');
      toggleButton.textContent = 'Open Valve';
      
      updateSimulation();
      
      // Clear log
      const logContainer = document.getElementById('log-container');
      logContainer.innerHTML = `
        <div class="log-entry error">System startup failed - temperature alarm</div>
        <div class="log-entry warning">Temperature: 45°C exceeds limit of 40°C</div>
        <div class="log-entry">Pump ready and valve operational</div>
        <div class="log-entry">Production halted due to high temperature</div>
      `;
      
      addLogEntry('Simulation reset to initial state', 'info');
    }

    function useSimulationTool(toolId) {
      const button = document.getElementById(toolId.replace('check-temp', 'check-offset').replace('use-thermometer', 'use-thermometer').replace('check-sensor', 'review-reports').replace('calibrate-sensor', 'adjust-offset'));
      button.disabled = true;
      
      switch(toolId) {
        case 'check-temp':
          addLogEntry('Checking system temperature readings...', 'info');
          setTimeout(() => {
            addLogEntry(`Displayed temperature: ${simulationData.displayedTemperature}°C`, 'info');
            addLogEntry(`Maximum allowed: ${simulationData.maxTemperature}°C`, 'info');
            addLogEntry(`Temperature status: ${simulationData.displayedTemperature > simulationData.maxTemperature ? 'OVER LIMIT' : 'NORMAL'}`, simulationData.displayedTemperature > simulationData.maxTemperature ? 'warning' : 'info');
            if (simulationData.displayedTemperature > simulationData.maxTemperature) {
              addLogEntry('System locked out due to high temperature', 'error');
            }
            button.disabled = false;
          }, 1000);
          break;
          
        case 'use-thermometer':
          addLogEntry('Using portable thermometer to verify temperature...', 'info');
          setTimeout(() => {
            addLogEntry(`Portable thermometer reading: ${simulationData.actualTemperature}°C`, 'info');
            button.disabled = false;
          }, 1000);
          break;
          
        case 'check-sensor':
          addLogEntry('Analyzing temperature sensor calibration...', 'info');
          setTimeout(() => {
            addLogEntry('Temperature sensor is working correctly', 'info');
            addLogEntry('Wiring is correct', 'info');
            button.disabled = false;
          }, 1000);
          break;
          
        case 'calibrate-sensor':
          addLogEntry('Checking temperature sensor setup...', 'info');
          setTimeout(() => {
            addLogEntry('Temperature sensor scalar correctly set', 'info');
            addLogEntry('Sensor scalar: 100 (matches datasheet specification)', 'info');
            addLogEntry('Sensor configuration verified', 'info');
            button.disabled = false;
          }, 1000);
          break;
      }
    }

    function addLogEntry(message, type = 'info') {
      const logContainer = document.getElementById('log-container');
      const logEntry = document.createElement('div');
      logEntry.className = `log-entry ${type}`;
      logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logContainer.appendChild(logEntry);
      logContainer.scrollTop = logContainer.scrollHeight;
    }
    */

    // Wi-Fi flickering function
    function startWifiFlicker() {
      const wifiStatus = document.getElementById('wifi-status');
      let isConnected = true;
      
      setInterval(() => {
        if (isConnected) {
          wifiStatus.textContent = 'DISCONNECTED';
          wifiStatus.className = 'status-value error';
        } else {
          wifiStatus.textContent = 'CONNECTED';
          wifiStatus.className = 'status-value normal';
        }
        isConnected = !isConnected;
      }, 2000); // Change every 2 seconds
    }
  </script>
</body>
</html> 