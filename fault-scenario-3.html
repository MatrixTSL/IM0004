<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Fault Scenario 3: CNC Coolant System Performance</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">
</head>
<body>
  <!-- Navigation -->
  <nav class="main-navigation">
    <div class="nav-container">
      <div class="nav-logo">
        <img src="assets/matrix-logo.png" alt="Matrix Logo">
      </div>
      <ul class="nav-menu">
        <li class="nav-item">
          <a href="#" onclick="window.location='index.html'" class="nav-link">
            <i class="fas fa-home"></i> HOME
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp0539-worksheets.html'" class="nav-link">
            <i class="fas fa-cogs"></i> CP0539
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp6773-worksheets.html'" class="nav-link active">
            <i class="fas fa-exclamation-triangle"></i> CP6773
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='settings.html'" class="nav-link">
            <i class="fas fa-gear"></i> SETTINGS
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='about.html'" class="nav-link">
            <i class="fas fa-info-circle"></i> ABOUT
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='fault-scenario-2.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Scenario</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Fault Scenario 3 - CNC Coolant System Performance</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='fault-scenario-4.html'">
            <span>Next Scenario</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- Introduction Section -->
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> Scenario Overview</h2>
      <div class="worksheet-content">
        <div class="scenario-info">
          <div class="info-grid">
            <div class="info-item">
              <strong>Company:</strong> Precision Manufacturing Inc.
            </div>
            <div class="info-item">
              <strong>Process:</strong> High-precision CNC machining operations
            </div>
            <div class="info-item">
              <strong>Shift:</strong> Investigation during day shift, problem occurs nights
            </div>
            <div class="info-item">
              <strong>Urgency:</strong> Medium - Production quality declining, potential equipment damage
            </div>
            <div class="info-item">
              <strong>Difficulty:</strong> Intermediate
            </div>
            <div class="info-item">
              <strong>Time:</strong> 30-40 minutes
            </div>
          </div>
        </div>

        <div class="background-section">
          <div class="background-text">
            <div class="scenario-description">
              <h3>Background</h3>
              <p>You're called to investigate a CNC machining facility where multiple machines are reporting spindle temperature warnings.</p>
              
              <p>The central coolant system that supplies all CNC machines shows normal pressure readings, but something isn't right.</p>
              
              <p>Operators report that the issue started gradually over the past month, coinciding with increased production demands.</p>
              
              <p>The facility recently increased production hours from 8 to 24 hours per day to meet customer demand.</p>
            </div>
          </div>
          
          <div class="background-image">
            <img src="assets/scenarios/cnc-cooling.png" alt="CNC Coolant System">
            <figcaption>CNC Coolant System - Precision Manufacturing</figcaption>
          </div>
        </div>

        <div class="system-overview">
          <h3>System Status</h3>
          <div class="status-grid">
            <div class="status-item">
              <span class="status-label">Coolant Temperature:</span>
              <span class="status-value">28°C</span>
            </div>
            <div class="status-item">
              <span class="status-label">Target Temperature:</span>
              <span class="status-value">22°C</span>
            </div>
            <div class="status-item">
              <span class="status-label">Coolant Pressure:</span>
              <span class="status-value">4.2 bar</span>
            </div>
            <div class="status-item">
              <span class="status-label">Target Pressure:</span>
              <span class="status-value">4.0 bar</span>
            </div>
            <div class="status-item">
              <span class="status-label">Flow Rate:</span>
              <span class="status-value">85%</span>
            </div>
            <div class="status-item">
              <span class="status-label">Target Flow Rate:</span>
              <span class="status-value">100%</span>
            </div>
            <div class="status-item">
              <span class="status-label">System Efficiency:</span>
              <span class="status-value warning">DECLINING</span>
            </div>
            <div class="status-item">
              <span class="status-label">Night Shift Performance:</span>
              <span class="status-value warning">POOR</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Troubleshooting Tips Section -->
    <div class="worksheet-section objectives-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> Troubleshooting Tips</h2>
      <div class="worksheet-content">
        <ul class="objectives-list">
          <li>Check coolant system maintenance schedules and filter conditions</li>
          <li>Monitor thermal cycling patterns and system efficiency trends</li>
          <li>Investigate the correlation between operational changes and performance</li>
          <li>Use systematic approach: check flow, pressure, temperature, and quality</li>
        </ul>
      </div>
    </div>

    <!-- Investigation Tools Section -->
    <div class="worksheet-section tools-section">
      <h2 class="section-header"><i class="fas fa-tools"></i> Investigation Tools</h2>
      <div class="worksheet-content">
        <div class="tools-grid">
          <div class="tool-card" data-tool="analyze_coolant_quality">
            <h4><i class="fas fa-flask"></i> Analyze Coolant Quality</h4>
            <p>Test coolant chemistry, pH, and contamination levels</p>
            <button class="tool-btn" onclick="useTool('analyze_coolant_quality')">Use Tool</button>
          </div>
          <div class="tool-card" data-tool="inspect_heat_exchanger">
            <h4><i class="fas fa-thermometer-half"></i> Inspect Heat Exchanger</h4>
            <p>Check for fouling, scaling, and thermal efficiency</p>
            <button class="tool-btn" onclick="useTool('inspect_heat_exchanger')">Use Tool</button>
          </div>
          <div class="tool-card" data-tool="monitor_temperature_cycles">
            <h4><i class="fas fa-chart-line"></i> Monitor Temperature Cycles</h4>
            <p>Track system temperature over 24-hour periods</p>
            <button class="tool-btn" onclick="useTool('monitor_temperature_cycles')">Use Tool</button>
          </div>
          <div class="tool-card" data-tool="verify_flow_distribution">
            <h4><i class="fas fa-water"></i> Verify Flow Distribution</h4>
            <p>Check flow rates to individual CNC machines</p>
            <button class="tool-btn" onclick="useTool('verify_flow_distribution')">Use Tool</button>
          </div>
        </div>
        
        <!-- Investigation Results Section -->
        <div id="investigation-results" class="investigation-results" style="display: none;">
          <h3 class="section-header"><i class="fas fa-search"></i> Investigation Results</h3>
          <div id="results-content">
            <!-- Results will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Simulation Section -->
    <div class="worksheet-section simulation-section">
      <h2 class="section-header"><i class="fas fa-cogs"></i> System Simulation</h2>
      <div class="worksheet-content">
        <div id="hmi-display-panel" class="simulation-container">
          <div class="simulation-loading">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading HMI simulation...</p>
          </div>
        </div>
        <div id="plc-io-panel" class="simulation-container" style="margin-top: 20px;">
          <div class="simulation-loading">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading PLC I/O simulation...</p>
          </div>
        </div>
        <div id="pump-simulation-panel" class="simulation-container" style="margin-top: 20px;">
          <div class="simulation-loading">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading pump simulation...</p>
          </div>
        </div>
        <div id="valve-simulation-panel" class="simulation-container" style="margin-top: 20px;">
          <div class="simulation-loading">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading valve simulation...</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Assessment Questions Section -->
    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Assessment Questions</h2>
      <div class="worksheet-content">
        <div class="question-card">
          <h3>Question 3.1</h3>
          <p>Why might the temperature issues be more prominent during night shift?</p>
          <div class="options">
            <label><input type="radio" name="q3.1" value="0"> Night shift operators are less experienced</label>
            <label><input type="radio" name="q3.1" value="1"> Ambient temperature is lower, affecting the cooling system</label>
            <label><input type="radio" name="q3.1" value="2"> Heat buildup accumulates throughout the day with no cooling recovery time</label>
            <label><input type="radio" name="q3.1" value="3"> Different CNC programs run at night</label>
          </div>
          <button onclick="submitAnswer('3.1')" class="submit-btn">Submit Answer</button>
        </div>
      </div>
    </div>
  </div>

  <script src="hmi-simulation.js"></script>
  <script src="plc-simulation.js"></script>
  <script src="pump-simulation.js"></script>
  <script src="valve-simulation.js"></script>
  <script>
    // Tool results data
    const toolResults = {
      'analyze_coolant_quality': {
        title: 'Coolant Quality Analysis Results',
        content: `
          <div class="result-item">
            <h4>Coolant Analysis Results:</h4>
            <ul>
              <li>pH Level: 9.2 (Normal: 8.5-9.0)</li>
              <li>Contamination: High levels of metal particles</li>
              <li>Coolant Age: 6 months (Exceeds recommended 3-month cycle)</li>
              <li>Bacterial Growth: Detected</li>
              <li>Concentration: 8% (Normal: 5-7%)</li>
            </ul>
            <p><strong>Analysis:</strong> The coolant has degraded significantly due to 24-hour operation without proper maintenance cycles. The high pH and contamination are reducing heat transfer efficiency.</p>
          </div>
        `
      },
      'inspect_heat_exchanger': {
        title: 'Heat Exchanger Inspection Results',
        content: `
          <div class="result-item">
            <h4>Heat Exchanger Condition:</h4>
            <ul>
              <li>Thermal Efficiency: 65% (Normal: 85-90%)</li>
              <li>Tube Fouling: Heavy scaling detected</li>
              <li>Pressure Drop: 2.5 bar (Normal: 1.0 bar)</li>
              <li>Last Maintenance: 8 months ago</li>
              <li>Recommended Service: Overdue by 5 months</li>
            </ul>
            <p><strong>Analysis:</strong> Significant fouling has reduced heat transfer efficiency by 35%. The scaling buildup is from continuous operation without maintenance intervals.</p>
          </div>
        `
      },
      'monitor_temperature_cycles': {
        title: 'Temperature Cycle Analysis',
        content: `
          <div class="result-item">
            <h4>24-Hour Temperature Monitoring:</h4>
            <ul>
              <li>Day Shift Start: 22°C</li>
              <li>Day Shift End: 25°C (+3°C)</li>
              <li>Night Shift Start: 25°C</li>
              <li>Night Shift End: 28°C (+3°C)</li>
              <li>Recovery Periods: None detected</li>
              <li>Cooling System Load: 95% (Normal: 60-70%)</li>
            </ul>
            <p><strong>Analysis:</strong> Temperature increases by 2-3°C per 8-hour shift with no recovery periods. The system reaches critical levels by night shift.</p>
          </div>
        `
      },
      'verify_flow_distribution': {
        title: 'Flow Distribution Results',
        content: `
          <div class="result-item">
            <h4>Flow Rate Analysis:</h4>
            <ul>
              <li>Main Pump Flow: 120 L/min (Normal: 150 L/min)</li>
              <li>Machine 1 Flow: 45 L/min (Required: 50 L/min)</li>
              <li>Machine 2 Flow: 35 L/min (Required: 50 L/min)</li>
              <li>Machine 3 Flow: 40 L/min (Required: 50 L/min)</li>
              <li>Pressure Drop: 1.8 bar (Normal: 1.0 bar)</li>
            </ul>
            <p><strong>Analysis:</strong> Flow rates to individual CNC machines are inconsistent. Some machines receiving only 60% of required flow due to system pressure drops and fouling.</p>
          </div>
        `
      }
    };

    // Use investigation tool
    function useTool(toolId) {
      const resultsSection = document.getElementById('investigation-results');
      const resultsContent = document.getElementById('results-content');
      const toolCard = document.querySelector(`[data-tool="${toolId}"]`);
      const toolBtn = toolCard.querySelector('.tool-btn');
      
      // Disable the tool button
      toolBtn.disabled = true;
      toolBtn.textContent = 'Used';
      
      // Show results
      const result = toolResults[toolId];
      resultsContent.innerHTML = `
        <h3>${result.title}</h3>
        ${result.content}
      `;
      resultsSection.style.display = 'block';
      
      // Scroll to results
      resultsSection.scrollIntoView({ behavior: 'smooth' });
    }
    
    function submitAnswer(questionId) {
      const selectedOption = document.querySelector(`input[name="q${questionId}"]:checked`);
      if (selectedOption) {
        const answer = parseInt(selectedOption.value);
        const correctAnswer = 2; // For question 3.1
        
        if (answer === correctAnswer) {
          alert('Correct! Heat buildup accumulates throughout the day with no cooling recovery time.');
        } else {
          alert('Incorrect. The correct answer is: Heat buildup accumulates throughout the day with no cooling recovery time.');
        }
        
        // Save answer
        localStorage.setItem(`fault-scenario-3-${questionId}`, answer);
      } else {
        alert('Please select an answer before submitting.');
      }
    }
    
    // Load saved answers on page load
    document.addEventListener('DOMContentLoaded', function() {
      const savedAnswer = localStorage.getItem('fault-scenario-3-3.1');
      if (savedAnswer !== null) {
        const radio = document.querySelector(`input[name="q3.1"][value="${savedAnswer}"]`);
        if (radio) radio.checked = true;
      }
      
      // Initialize simulations
      setTimeout(() => {
        if (typeof initializeHMISimulation === 'function') {
          initializeHMISimulation();
        }
        if (typeof initializePLCSimulation === 'function') {
          initializePLCSimulation();
        }
        if (typeof initializePumpSimulation === 'function') {
          initializePumpSimulation();
        }
        if (typeof initializeValveSimulation === 'function') {
          initializeValveSimulation();
        }
      }, 1000);
    });
  </script>
</body>
</html> 
